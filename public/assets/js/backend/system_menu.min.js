$(document).ready(function(){function e(t){var a="<li class='dd-item' data-slug='"+t.Slug+"' data-title='"+t.CategoryName+"' data-id='"+t.CategoryID+"' id='"+t.CategoryID+"'>";return a+="<a href='javascript:;'' class='pull-right delete-category' data-id='"+t.CategoryID+"'><i class='fa fa-trash'></i></a><div class='dd-handle'>"+t.CategoryName+"</div>",t.children&&(a+="<ol class='dd-list'>",$.each(t.children,function(t,n){a+=e(n)}),a+="</ol>"),a+="</li>"}var t=$("#initMenu").val();$.each(JSON.parse(t),function(t,a){$("#nestable_list_menu #list-menu").append(e(a))}),$(".dd").nestable({}),$(".icon-picker").iconpicker(),$("#formAddMenu").livequery("submit",function(e){e.preventDefault();var t=$(this).serialize();$.ajax({url:"system/menu",type:"POST",dataType:"json",data:t}).done(function(e){"success"==e.code&&$("#list-menu").append(e.html)}).fail(function(){console.log("error")}).always(function(){console.log("complete")})}),$(".btn-save-menu").livequery("click",function(){var e=($(this),$(".dd").nestable("serialize"));e="obj="+JSON.stringify(e),$.ajax({url:"system/menu",type:"PUT",dataType:"json",data:e,headers:{"X-CSRF-TOKEN":$('meta[name="__public_token"]').attr("content")}}).done(function(e){toastr.success(e.message)}).fail(function(e){toastr.error(e.message)}).always(function(){console.log("complete")})}),$(".delete-category").livequery("click",function(){var e=$(this),t=e.attr("data-id");swal({title:"Bạn có chắc chắn?",text:"Tất cả category con của category này sẽ bị xoá cùng!",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Xoá",closeOnConfirm:!1},function(){$.ajax({url:"system/menu/"+t,type:"DELETE",dataType:"json",data:{},headers:{"X-CSRF-TOKEN":$('meta[name="__public_token"]').attr("content")}}).done(function(e){return 200==e.code?(toastr.success(e.message),!1):void swal("Opps!","Xoá chưa thành công","error")}).fail(function(){toastr.error(data.message)}).always(function(){console.log("complete")})})})});